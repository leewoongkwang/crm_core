{% extends "base.html" %}

{% block title %}14터치 메시지 전송{% endblock %}
{% block page_title %}14터치 메시지 전송{% endblock %}

{% block content %}
<form method="post" enctype="multipart/form-data">
  {% csrf_token %}
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">

    <!-- ✅ 좌측: 전송 대상 고객 리스트 -->
    <section class="bg-white p-4 rounded shadow col-span-1">
      <h2 class="text-md font-bold mb-4">📋 전송 대상 고객</h2>
      <ul class="space-y-2 text-sm">
        {% for customer in customers %}
        <li class="border p-2 rounded bg-blue-50">
          <strong>{{ customer.name }}</strong> / {{ customer.gender }} / {{ customer.insurance_age }}세<br>
          등급: {{ customer.grade }} / 최근 터치: {{ customer.last_touch_date }}
        </li>
        {% endfor %}
      </ul>
    </section>

    <!-- ✅ 중앙: 메시지 작성 영역 -->
    <section class="bg-white p-4 rounded shadow col-span-1">
      <h2 class="text-md font-bold mb-4">✍️ 메시지 작성</h2>
      <select name="type" class="w-full border p-2 rounded mb-2 text-sm">
        <option value="14touch">14터치</option>
        <option value="콜">콜</option>
        <option value="방문">방문</option>
        <option value="파싱">파싱</option>
        <option value="기타">기타</option>
      </select>

      <textarea name="content" rows="6" class="w-full border p-2 rounded mb-2" placeholder="전송할 메시지를 입력하세요..."></textarea>
      <textarea name="strategy_note" class="w-full border p-2 rounded mb-2" placeholder="터치 전략 메모 (선택)"></textarea>
      <textarea name="medical_history" class="w-full border p-2 rounded mb-2" placeholder="병력 정보 (선택)"></textarea>
      <input name="underwriting_status" class="w-full border p-2 rounded mb-2" placeholder="심사 상태 (Y/N/보류)">
      <textarea name="underwriting_result" class="w-full border p-2 rounded mb-2" placeholder="심사 결과 요약 (선택)"></textarea>
      <textarea name="insurance_products" class="w-full border p-2 rounded mb-2" placeholder="관련 보험 상품 (선택)"></textarea>

      <div class="flex space-x-2">
        <button type="button" class="px-3 py-1 text-sm bg-gray-200 rounded">추천 메시지 불러오기</button>
        <button type="button" class="px-3 py-1 text-sm bg-gray-200 rounded">템플릿 저장/불러오기</button>
      </div>
      <p class="text-xs text-gray-500 mt-2">* 메시지는 고객 이름 없이 전송됩니다. 수신 동의 여부 확인 필수</p>
    </section>

    <!-- ✅ 우측: 이미지 첨부 및 전송 -->
    <section class="bg-white p-4 rounded shadow col-span-1">
      <h2 class="text-md font-bold mb-4">📎 이미지 첨부</h2>
      <div class="border-dashed border-2 border-gray-300 p-4 rounded text-center mb-4">
        <p class="text-gray-500 text-sm">드래그 & 드롭 or 파일 선택</p>
        <input type="file" name="image" class="mt-2 text-sm">
      </div>
      <button type="submit" class="w-full py-2 bg-blue-600 text-white rounded">전송</button>
      <p class="text-xs text-gray-500 mt-2">전송 시 자동으로 터치기록이 저장됩니다.</p>
    </section>

  </div>
</form>
{% endblock %}
